TODO
====

GUIDELINES
----------

* Whenever (if) we need to add code to a repo, propose to create a PR, not to commit it directly

TODO PRIVATE BETA
-----------------

* help
    * how to use sass/compass
    * how to provision my containers using...
        * puppet
        * chef
        * cfengine
        * ansible
        * salt
        * an heroku buildpack
* builds
    * switch runtime to supervisor or something to make sure everything runs as it should
* global
    * have contextual help everywhere it matters
* dashboard
    * list of running instances grouped by project and order by project.last_build_id
* projects
    * support dependencies in a gitlab instance
    * update project access when an user joins the project
* logs
    * application logs

SCALING
=======

* feature switches for (almost) everything
* read-only mode

THIRD PARTY INTEGRATION
=======================

* https://github.com/marmelab/gaudi
* http://wercker.com/
* github deployment API
* Gitlab
* Bitbucket

TODO
====

* Github
    * periodically check for access_token validity and warn user if it expired

* Commands
    * project:audit
        * is the webhook configured?
    * commands to empty redis

* REST API / webhooks

* production
    * everything needs to transit through SSL
    * needs to have working error reporting
    * needs to have proper monitoring

* instances
    * auth: have the reverse proxy render the auth page instead of redirecting to the php app (for custom domains)

* builds
    * check that the runtime container was successfuly built
    * check the desired branch is available
    * running and building status are confusing
    * the build process must be completely error/fool proof
    * make the symfony builder a bit more clever
        * things that should work ootb
            * doctrine orm/odm
            * doctrine/alice fixtures
            * mysql/pgsql
            * mongodb/couchdb
            * redis/memcached
    * disallow scheduling a build if a running instance for the same hash exists
    * log trigger source (manual / push)
    * before build: check that the app is actually buildable (eg: there is a composer.json)
    * before starting a build, check that the required docker image is present
    * rewrite the build system, with extensibility in mind
        * build steps could be infered at import time (or pre-build time)
        * a build file could be generated with said steps
        * the builder would iterate through the build file, run steps and check their exit status
        * if a step fails, the builder fails
        * also, if a specific step fail, we know what it exactly is, so we can try and guess why it did fail and
          tell the user steps to take to fix it (or maybe fix it automatically, I'm looking at you, missing deploy key)
    * checkbox "go to this build when it's finished" (?)
    * container ports should be bound on local private IPs instead of stage1.io public IP
    * alerts
        * push notif
        * mail
        * webhooks
    * support Procfiles (?)

* projects
    * last_build_at + last_build_ref (last_build_id ?)
    * allow per-project docker image selection
        This should not be in the UI, it's an admin (as in, me) only feature for now
        This will be used for non-symfony alpha testers and to PoC the per-project-image thingy
    * access (?)
        * implement "one-time-access-granting" URLs
        * implement "one-time" passwords
        * implement auto-expiring accesses
        * implement "access-granting-referers" (automatically gain access if you come from the project's github for example)
    * on remove
        * remove deploy key
        * remove hook

* public admin
    * public dashboard
        * global number of builders
        * number of availables builders
        * number of running builders
        * number of running instances

* admin
    * bundle to override container parameters per user

* misc UI
    * show useful indicators of what's happening in the title bar when the window is out of focus
    * all "stateful buttons" should present an option to "retry" when failed
    * timeout long running ajax queries with a message like "uhoh, this is taking longer than expected"
    * pre-disabled buttons should change to enabled state when needed (through websockets events eg)

* websockets
    * update project access page when an ip is added to the access list
    * update project access page when a master password is set/unset
    * buffered channels implementation is a terrible mess
    * do not subscribe a user to all sub-channels he's allowed to, but rather
      check if an incoming message is going through a channel that's a sub-channel
      of a currently subscribed channel

* VM / provisioning
    * use GNU parallel to speed up VM packing and provisioning

GITHUB ENTERPRISE
=================

A problem will be github's API rate limit and composer, because the access token we have is not a valid github.com access token (it's a github enterprise token). So we have two, maybe three, solutions:

1. acquire a github.com application token specific to this stage1 instance
2. acquire a github.com through the user
3. bundle the VM with an installation of satis

THE DISTANT FUTURE
==================

* see if https://github.com/travis-ci/travis-build is monkey patchable to not include script and after_script

* builds
    * log queue time
    * separate builds and jobs
    * "build now", premium option to bypass all queuing rules and have your project built now, as in, NOW.
    * Support for build systems like make, ant, phing, etc

* instances
    * add a (disablable) top frame indicating what project / branch you're currently browsing
    * allow shutting down / restarting a running instance
    * http://mailcatcher.me/
    * reverse proxy: remove auth cookie in proxied request and reput it in response

* projects
    * allow project creation through build poke (?)
    * autodetect new projects 
        run periodic background checks to the user's github account for new importable projects
    * symfony
        * allow env selection (dev / prod)
    * allow non-github projects (?)

* bi-directionnal communication
    * update web ui accordingly for the following events
        * new project (detected through a build poke)

* runtimes
    * premium option to allow a user to build his own docker image and then assign it to his projects
    * internal docker registry where users can push their own runtimes
    * support buildpacks, packer, chef, puppet


* misc
    * pusher private channels to receive push notif about your projects' builds

DEMO
----

* add the place of the build in the builds queue (?)
* limit number of demo build to 1 per email
* if someone tries to launch a demo build with an already used email, try some marketing

DEMO PROJECTS
-------------

* symfony cmf / sulu cmf / sonata sandbox
* orocrm
* sylius
* puphpet (to remove, too confusing)
* akeneo
* ekino cms ?

IDEES DE OUF
============

* le client peut annoter la preprod
* stage1 enregistre les actions des clients (clic la, clic la, tape ca, clic la)
    * faire gaffe aux infos sensibles (numeros de CB, telephone)
* multiplexage de la session (tu vois ce que le client fait en live)
    * possibilite de discuter avec lui via un chat integre
* feature de "touring" sur la preprod
* possibilite de setup des surveys pour poser des questions aux users
* integration avec mailcatcher
* integration avec gor (https://github.com/buger/gor)