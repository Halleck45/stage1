TODO URGENT
===========

BUGS
----
* build failed: 2013/08/10 06:40:21 Unable to set up networking: ip failed: ip route add default via 172.17.42.1 (see https://github.com/dotcloud/docker/pull/1374)

TODO PRIVATE BETA
-----------------

* global
    * have contextual help everywhere it matters
* production
    * needs to have working error reporting
    * needs to have proper monitoring
* projects
    * multi-owners
    * explain how the master password works
    * delete access list on project deletion
* dashboard
    * list of running instances grouped by project and order by project.last_build_id
* builds
    * killing a build does not seem to kill its container
    * add a timeout on builds (5min for starters)
* projects
    * last_build_at + last_build_ref (last_build_id ?)

SCALING
=======

* feature switches for (almost) everything
* read-only mode

TODO
====

* Commands
    * project:audit
        * number of occurences in database
        * number of builds
        * number of building builds
        * number of running instances
        * owner(s)
        * is the deploy key configured?
        * is the webhook configured?

* REST API / webhooks

* production
    * everything needs to transit through SSL

* user
    * explicitely ask github for the private emails 

* instances
    * auth: have the reverse proxy render the auth page instead of redirecting to the php app (for custom domains)

* builds
    * running and building status are confusing
    * the build process must be completely error/fool proof
    * make the symfony builder a bit more clever
        * things that should work ootb
            * doctrine orm/odm
            * doctrine/alice fixtures
            * mysql/pgsql
            * mongodb/couchdb
            * redis/memcached
    * disallow scheduling a build if a running instance for the same hash exists
    * log build time
    * log trigger source (manual / push)
    * before build: check that the app is actually buildable (eg: there is a composer.json)
    * before starting a build, check the required docker image is present
    * need a way to update buildapp in runtime without re building the whole image
    * rewrite the build system, with extensibility in mind
        * build steps could be infered at import time (or pre-build time)
        * a build file could be generated with said steps
        * the builder would iterate through the build file, run steps and check their exit status
        * if a step fails, the builder fails
        * also, if a specific step fail, we know what it exactly is, so we can try and guess why it did fail and
          tell the user steps to take to fix it (or maybe fix it automatically, I'm looking at you, missing deploy key)
    * checkbox "go to this build when it's finished"
    * container ports should be bound on local private IPs instead of stage1.io public IP
    * alerts
        * push notif
        * mail
        * webhooks
    * have a way to configure ENV variables in the container
    * export a few ENV var for easier configuration (see http://symfony.com/doc/current/cookbook/configuration/external_parameters.html)
    * support Procfiles

* projects
    * allow per-project docker image selection
        This should not be in the UI, it's an admin (as in, me) only feature for now
        This will be used for non-symfony alpha testers and to PoC the per-project-image thingy
    * import should make ajax queries to stage1 instead of directly querying github
    * access
        * implement "one-time-access-granting" URLs
        * implement "one-time" passwords
        * implement auto-expiring accesses
        * implement "access-granting-referers" (automatically gain access if you come from the project's github for example)

* public admin
    * public dashboard
        * global number of builders
        * number of availables builders
        * number of running builders
        * number of running instances

* admin
    * monitor all running docker container
    * ability to kill / top any running docker container
    * manually schedule builds for any project/branch
    * bundle to override container parameters per user

* misc UI
    * explain what exactly happens when importing a project (deploy key + webhooks setup)
    * show useful indicators of what's happening in the title bar when the window is out of focus
    * all "stateful buttons" should present an option to "retry" when failed
    * timeout long running ajax queries with a message like "uhoh, this is taking longer than expected"
    * pre-disabled buttons should change to enabled state when needed (through websockets events eg)

* websockets
    * update project access page when an ip is added to the access list
    * update project access page when a master password is set/unset
    * buffered channels implementation is a terrible mess

* VM / provisioning
    * use GNU parallel to speed up VM packing and provisioning

GITHUB ENTERPRISE
=================

A problem will be github's API rate limit and composer, because the access token we have is not a valid github.com access token (it's a github enterprise token). So we have two, maybe three, solutions:

1. acquire a github.com application token specific to this stage1 instance
2. acquire a github.com through the user
3. bundle the VM with an installation of satis

THE DISTANT FUTURE
==================

* see if https://github.com/travis-ci/travis-build is monkey patchable to not include script and after_script

* builds
    * log queue time
    * separate builds and jobs
    * "build now", premium option to bypass all queuing rules and have your project built now, as in, NOW.
    * add option to specify a build script
        * SECURITY WARNING
    * Support for build systems like make, ant, phing, etc

* instances
    * add a (disablable) top frame indicating what project / branch you're currently browsing
    * allow shutting down / restarting a running instance
    * http://mailcatcher.me/
    * reverse proxy: remove auth cookie in proxied request and reput it in response

* projects
    * allow project creation through build poke (?)
    * autodetect new projects 
        run periodic background checks to the user's github account for new importable projects
    * symfony
        * allow env selection (dev / prod)
    * allow non-github projects (?)

* bi-directionnal communication
    * update web ui accordingly for the following events
        * new project (detected through a build poke)

* runtimes
    * premium option to allow a user to build his own docker image and then assign it to his projects
    * support buildpacks, packer, chef, puppet


* misc
    * pusher private channels to receive push notif about your projects' builds

IDEES DE OUF
============

* le client peut annoter la preprod
* stage1 enregistre les actions des clients (clic la, clic la, tape ca, clic la)
    * faire gaffe aux infos sensibles (numeros de CB, telephone)
* multiplexage de la session (tu vois ce que le client fait en live)