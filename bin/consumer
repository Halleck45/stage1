#!/bin/bash
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
PID_DIR="/tmp/run"

case $1 in 
    start)
        if [ ! -d $PID_DIR ]; then
            mkdir -p $PID_DIR
        fi
        
        echo $$ > $PID_DIR/$2.pid
        exec 2>&1 /usr/bin/php $DIR/../app/console rabbitmq:consumer -vvv -w $2
        ;;
    stop)
        kill -9 `cat $PID_DIR/$2.pid`
        ;;
    *)
        echo "usage $0 {start|stop} consumer-name"
esac
exit 0