{% extends '::base.html.twig' %}

{% block javascripts %}
<script src="/project_builds.js"></script>
{% endblock javascripts %}

{% block body %}
{% include 'AppCoreBundle:Default:_project_header.html.twig' %}

{% if project.builds | length == 0 %}
<p class="lead">No build?! Come on, get to work and push some code!</p>

<p>Or you can also <a href="{{ path('app_core_project_branches', { id: project.id }) }}">manually schedule a build</a> in the meantine.</p>
{% else %}
<p class="lead">Found <strong>{{ project.builds | length }}</strong> build{% if project.builds | length != 1 %}s{% endif %} for project {{ project.name }}.</p>
<table id="builds" class="table table-striped">
    <thead>
        <tr>
            <th width="5%">Id</th>
            <th width="15%">Branch</th>
            <th width="10%">Hash</th>
            <th width="20%">Created at</th>
            <th width="10%">Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for build in project.builds %}
        <tr id="build-{{ build.id }}" class="status-{{ build.statusLabel }} branch-{{ build.ref }}">
            <td>#{{ build.id }}</td>
            <td>{{ build.ref }}</td>
            <td><abbr title="{{ build.hash }}">{{ build.hash[0:8] }}</abbr></td>
            <td>{{ build.createdAt | date('Y-m-d H:i:s') }}</td>
            <td>{{ build.statusLabel }}</td>
            <td class="actions">
                {% if build.scheduled %}
                <form method="post" action="{{ path('app_core_build_cancel', { id: build.id }) }}">
                    <button type="submit" class="btn btn-warning">Cancel</button>
                </form>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}
{% endblock body %}